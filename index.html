<!doctype html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>Detectable</title>
		<link href="jquery.mobile-1.3.2.css" rel="stylesheet" type="text/css">
		<!--<link rel="stylesheet" href="themes/detectable.min.css" />-->
		<link rel="stylesheet" href="http://code.jquery.com/mobile/1.3.2/jquery.mobile.structure-1.3.2.min.css" />
		<style type="text/css">
			html {
				height: 100%
			}
			body {
				height: 100%;
				margin: 0;
				padding: 0
			}
			#map-canvas {
				height: 100%
			}
		</style>
		<script src="http://code.jquery.com/jquery-1.9.1.min.js"></script>
		<link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.6.4/leaflet.css" />
		<!--[if lte IE 8]>
		<link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.6.4/leaflet.ie.css" />
		<![endif]-->

		<script src="http://cdn.leafletjs.com/leaflet-0.6.4/leaflet.js"></script>
		<script src="http://code.jquery.com/mobile/1.3.2/jquery.mobile-1.3.2.min.js"></script>
		<script type="text/javascript"	src="https://maps.googleapis.com/maps/api/js?key={AIzaSyCqlLxOCxnNxGJ_ZQiPdQApiyL4zNd5xxw}&sensor=true"></script>

		<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?libraries=geometry,drawing,places,visualization&sensor=true"></script>
	</head>

	<body>
		<!-- LANDING PAGE -->

		<!-- header -->
		<div data-role="page" id="landing">
			<div data-role="header" id="header">
				<h1>9:00 PM</h1>
				<form>
					<div data-role="fieldcontain">  
						<label for="slider-7">Timeline</label>
						<input type="range" name="slider-7" id="slider-7" data-highlight="true" min="0" max="12" value="0">
					</div>
				</form>
				<a href="#popupMenu" data-icon="bars" data-role="button" data-shadow="false" data-iconpos="notext" data-rel="popup" class="ui-icon-nodisc" class="ui-btn-right">Options</a>
				<div data-role="popup" id="popupMenu">
					<ul data-role="listview" data-inset="true" style="min-width:210px;">
						<li data-role="divider">
							Sort by
						</li>
						<li>
							<a href="#">Alternate Routes</a>
						</li>
						<li>
							<a href="#">Switch Directions</a>
						</li>
					</ul>
				</div>
			</div>
			<!-- content -->
			<div data-role="content" id="map-canvas" style="width: 100%; height: 100%"></div>
			<!-- footer -->
			<div data-role="footer" data-id="foo1" data-position="fixed">
				<!-- navbar -->
				<div data-role="navbar">
					<ul>
						<li>
							<a href="#landing" data-icon="home" data-transition="slide">Map</a>
						</li>
						<li>
							<a href="#reports" data-icon="info" data-transition="slide">Reports</a>
						</li>
						<li>
							<a href="#popupDialog" data-icon="plus" data-rel="popup" data-position-to="window" data-role="button" data-close-btn="none">New</a>
							<div data-role="popup" id="popupDialog" data-dismissible="false" style="max-width:400px;" class="ui-corner-all">
								<div data-role="header" data-theme="a" class="ui-corner-top">
									<h1>New...</h1>
								</div>
								<div data-role="content" class="ui-corner-bottom ui-content">
									<form>
										<fieldset data-role="controlgroup" data-type="horizontal">
											<input type="radio" name="radio-choice-h-2" id="radio-choice-h-2a" value="on" checked="checked">
											<label for="radio-choice-h-2a">Route</label>
											<input type="radio" name="radio-choice-h-2" id="radio-choice-h-2b" value="off">
											<label for="radio-choice-h-2b">Report</label>
										</fieldset>
									</form>
									<form>
										<label for="datetime-3">Date and Time</label>
										<input type="datetime-local" data-clear-btn="false" name="datetime-3" id="datetime-3" value="">
									</form>
									<form>
										<label for="text-1">Name</label>
										<input type="text" data-clear-btn="true" name="text-1" id="text-1" value="" placeholder="(optional)">
									</form>
									<form>
										<fieldset data-role="controlgroup" data-type="horizontal" data-mini="true" id="severity">
											<legend>
												Severity
											</legend>
											<input type="radio" data-theme="a" name="radio-choice-t-6" id="radio-choice-t-6a" value="on" checked="checked">
											<label for="radio-choice-t-6a">1</label>
											<input type="radio" data-theme="a" name="radio-choice-t-6" id="radio-choice-t-6b" value="off">
											<label for="radio-choice-t-6b">2</label>
											<input type="radio" data-theme="a" name="radio-choice-t-6" id="radio-choice-t-6c" value="other">
											<label for="radio-choice-t-6c">3</label>
										</fieldset>
									</form>
									<a href="#" data-role="button" data-rel="back" data-theme="c" data-icon="delete" data-iconpos="notext" data-inline="true">Cancel</a>
									<a href="#" data-role="button" id="btn-create" data-rel="back" data-transition="flow" data-theme="b" data-icon="check" data-iconpos="notext" data-inline="true">Create</a>
								</div>
							</div>
						</li>
						<li>
							<a href="#routes" data-icon="star" data-transition="slide">Routes</a>
						</li>
						<li>
							<a href="#settings" data-icon="gear" data-transition="slide">Settings</a>
						</li>
					</ul>
				</div>
			</div>
		</div>

		<!-- MY REPORTS -->

		<!-- header -->
		<div data-role="page" id="reports">
			<div data-role="header">
				<a href="#landing" data-icon="arrow-l" data-shadow="false" data-iconpos="notext" data-rel="back" class="ui-icon-nodisc">Back</a>
				<h1>My Reports</h1>
				<a href="#popupMenu" data-icon="bars" data-role="button" data-shadow="false" data-iconpos="notext" data-rel="popup" class="ui-icon-nodisc">Options</a>
				<div data-role="popup" id="popupMenu">
					<ul data-role="listview" data-inset="true" style="min-width:210px;">
						<li data-role="divider">
							Sort by
						</li>
						<li>
							<a href="#">Alphabet</a>
						</li>
						<li>
							<a href="#">Time</a>
						</li>
					</ul>
				</div>
			</div>
			<!-- content -->
			<div data-role="content">
				<form>
					<label for="search-1" class="ui-hidden-accessible">Search:</label>
					<input type="search" name="search-1" id="reportsSearch" value="" placeholder="Search" >
				</form>
				<hr>
				<ul data-role="listview">
					<li data-icon="false">
						<a href="#popupDialog" data-rel="dialog"> <h2>Super sketch area</h2>
						<p>
							35th St &amp; Habersham St — 10:00 PM
						</p></a>
					</li>
					<li data-icon="false">
						<a href="#"> <h2>Fahm</h2>
						<p>
							Fahm St &amp; W Bryan St
						</p></a>
					</li>
					<li data-icon="false">
						<a href="#"> <h2>Untitled Report</h2>
						<p>
							Montgomery &amp; W Park Ave — 2:00 AM
						</p></a>
					</li>
					<li data-icon="false">
						<a href="#"> <h2>David got mugged here</h2>
						<p>
							54th St &amp; Reynolds St — 9:00 PM
						</p></a>
					</li>
				</ul>
			</div>
			<!-- footer -->
			<div data-role="footer" data-id="foo1" data-position="fixed">
				<!-- navbar -->
				<div data-role="navbar">
					<ul>
						<li>
							<a href="#landing" data-icon="home" data-transition="slide">Map</a>
						</li>
						<li>
							<a href="#reports" data-icon="info" data-transition="slide">Reports</a>
						</li>
						<li>
							<a href="#popupDialog" data-icon="plus" data-rel="popup" data-position-to="window" data-role="button" data-close-btn="none">New</a>
							<div data-role="popup" id="popupDialog" data-dismissible="false" style="max-width:400px;" class="ui-corner-all">
								<div data-role="content" class="ui-corner-bottom ui-content">
									<h3 class="ui-title">New: Route Report</h3>
									<h3 class="ui-title">At: 9:00 AM PM</h3>
									<a href="#" data-role="button" data-rel="back" data-theme="c" data-icon="delete" data-iconpos="notext" data-inline="true">Cancel</a>
									<a href="#" data-role="button" data-rel="back" data-transition="flow" data-theme="b" data-icon="check" data-iconpos="notext" data-inline="true">Okay</a>
								</div>
							</div>
						</li>
						<li>
							<a href="#routes" data-icon="star" data-transition="slide">Routes</a>
						</li>
						<li>
							<a href="#settings" data-icon="gear" data-transition="slide">Settings</a>
						</li>
					</ul>
				</div>
			</div>
		</div>

		<!-- MY ROUTES -->

		<!-- header -->
		<div data-role="page" id="routes">
			<div data-role="header">
				<a href="#landing" data-icon="arrow-l" data-shadow="false" data-iconpos="notext" data-rel="back" class="ui-icon-nodisc">Back</a>
				<h1>My Routes</h1>
				<a href="#popupMenu" data-icon="bars" data-role="button" data-shadow="false" data-iconpos="notext" data-rel="popup" class="ui-icon-nodisc">Options</a>
				<div data-role="popup" id="popupMenu">
					<ul data-role="listview" data-inset="true" style="min-width:210px;">
						<li data-role="divider">
							Sort by
						</li>
						<li>
							<a href="#">Alphabet</a>
						</li>
						<li>
							<a href="#">Time</a>
						</li>
					</ul>
				</div>
			</div>
			<!-- content -->
			<div data-role="content">
				<form>
					<label for="search-1" class="ui-hidden-accessible">Search:</label>
					<input type="search" name="search-1" id="reportsSearch" value="" placeholder="Search" >
				</form>
				<hr>
				<ul data-role="listview">
					<li data-icon="false">
						<a href="#"> <h2>Chinatown Market</h2>
						<p>
							Price St &amp; E Henry St
						</p></a>
					</li>
					<li data-icon="false">
						<a href="#"> <h2>Amy's House</h2>
						<p>
							E Taylor St &amp; E Broad St
						</p></a>
					</li>
					<li data-icon="false">
						<a href="#"> <h2>Kevin and</h2>
						<p>
							Howard St &amp; W Bolton
						</p></a>
					</li>
					<li data-icon="false">
						<a href="#"> <h2>David got mugged here</h2>
						<p>
							54th St &amp; Reynolds St
						</p></a>
					</li>
				</ul>
			</div>
			<!-- footer -->
			<div data-role="footer" data-id="foo1" data-position="fixed">
				<!-- navbar -->
				<div data-role="navbar">
					<ul>
						<li>
							<a href="#landing" data-icon="home" data-transition="slide" data-direction="reverse">Map</a>
						</li>
						<li>
							<a href="#reports" data-icon="info" data-transition="slide" data-direction="reverse">My Reports</a>
						</li>
						<li>
							<a href="#routes" data-icon="star" data-transition="slide">My Routes</a>
						</li>
						<li>
							<a href="#settings" data-icon="gear" data-transition="slide">Settings</a>
						</li>
						<li>
							<a href="#popupDialog" data-icon="plus" data-rel="popup" data-position-to="window" data-role="button" data-close-btn="none">New</a>
							<div data-role="popup" id="popupDialog" data-dismissible="false" style="max-width:400px;" class="ui-corner-all">
								<div data-role="content" class="ui-corner-bottom ui-content">
									<h3 class="ui-title">New: Route Report</h3>
									<h3 class="ui-title">At: 9:00 AM PM</h3>
									<a href="#" data-role="button" data-rel="back" data-theme="c" data-icon="delete" data-iconpos="notext" data-inline="true">Cancel</a>
									<a href="#" data-role="button" data-rel="back" data-transition="flow" data-theme="b" data-icon="check" data-iconpos="notext" data-inline="true">Okay</a>
								</div>
							</div>
						</li>
					</ul>
				</div>
			</div>
		</div>

		<!-- SETTINGS -->

		<!-- header -->
		<div data-role="page" id="settings">
			<div data-role="header">
				<h1>9:00 PM</h1>
			</div>
			<!-- content -->
			<div data-role="content">
				<ul data-role="listview">
					<li data-icon="false">
						<a href="#" data-rel="dialog"> <h2>Account</h2>
						<p>
							morkim20@student.scad.edu
						</p></a>
					</li>
					<li data-icon="false">
						<a href="#"> <h2>Time settings</h2></a>
					</li>
					<li data-icon="false">
						<a href="#"> <h2>Tutorials &amp; help</h2></a>
					</li>
					<li data-icon="false">
						<a href="#"> <h2>Send feedback</h2></a>
					</li>
					<li data-icon="false">
						<a href="#"> <h2>About, terms &amp; privacy</h2></a>
					</li>
				</ul>
			</div>
			<!-- footer -->
			<div data-role="footer" data-id="foo1" data-position="fixed">
				<!-- navbar -->
				<div data-role="navbar">
					<ul>
						<li>
							<a href="#landing" data-icon="home" data-transition="slide" data-direction="reverse">Map</a>
						</li>
						<li>
							<a href="#reports" data-icon="info" data-transition="slide" data-direction="reverse">My Reports</a>
						</li>
						<li>
							<a href="#routes" data-icon="star" data-transition="slide" data-direction="reverse">My Routes</a>
						</li>
						<li>
							<a href="#settings" data-icon="gear" data-transition="slide">Settings</a>
						</li>
						<li>
							<a href="#popupDialog" data-icon="plus" data-rel="popup" data-position-to="window" data-role="button" data-close-btn="none">New</a>
							<div data-role="popup" id="popupDialog" data-dismissible="false" style="max-width:400px;" class="ui-corner-all">
								<div data-role="content" class="ui-corner-bottom ui-content">
									<h3 class="ui-title">New: Route Report</h3>
									<h3 class="ui-title">At: 9:00 AM PM</h3>
									<a href="#" data-role="button" data-rel="back" data-theme="c" data-icon="delete" data-iconpos="notext" data-inline="true">Cancel</a>
									<a href="#" data-role="button" data-rel="back" data-transition="flow" data-theme="b" data-icon="check" data-iconpos="notext" data-inline="true">Okay</a>
								</div>
							</div>
						</li>
					</ul>
				</div>
			</div>
		</div>

		<!-- NEW -->

		<!-- header -->
		<!--<div data-role="page" id="new">
		<div data-role="header">
		<h1>9:00 PM</h1>
		</div>
		<!-- content -->
		<div data-role="content">
			<p>
				I'm first in the source order so I'm shown as the page.
			</p>
			<p>
				View internal page called <a href="#bar">bar</a>
			</p>
		</div>
		<!-- footer -->
		<div data-role="footer" data-id="foo1" data-position="fixed">
			<!-- navbar -->
			<div data-role="navbar" id="navbar">
				<ul>
					<li>
						<a href="#landing" data-icon="home" data-transition="slide" data-direction="reverse">Map</a>
					</li>
					<li>
						<a href="#reports" data-icon="info" data-transition="slide" data-direction="reverse">My Reports</a>
					</li>
					<li>
						<a href="#routes" data-icon="star" data-transition="slide" data-direction="reverse">My Routes</a>
					</li>
					<li>newReport
						<a href="#settings" data-icon="gear" data-transition="slide" data-direction="reverse">Settings</a>
					</li>
					<li>
						<a href="#" id="newReport" data-icon="plus" data-transition="slide" data-direction="reverse">New</a>
						<!-- <a href="#popupDialog" data-icon="plus" data-rel="popup" data-position-to="window" data-role="button" data-close-btn="none">New</a>
						<div data-role="popup" id="popupDialog" data-dismissible="false" style="max-width:400px;" class="ui-corner-all">
							<div data-role="content" class="ui-corner-bottom ui-content">
								<h3 class="ui-title">New: Route Report</h3>
								<h3 class="ui-title">At: 9:00 AM PM</h3>
								<a href="#" data-role="button" data-rel="back" data-theme="c" data-icon="delete" data-iconpos="notext" data-inline="true">Cancel</a>
								<a href="#" data-role="button" data-rel="back" data-transition="flow" data-theme="b" data-icon="check" data-iconpos="notext" data-inline="true">Okay</a>
							</div>
						</div> -->
					</li>
				</ul>
			</div>
		</div>
		<script>
			var selectLocation = false;
			$(document).ready(function() {
				sizeMap();
				var map = L.map('map-canvas');
				var my_markers = new Array();

				// Putting incidents in the data array
				// 31.977151982694277 -81.2409782409668
				my_markers.push({
					lat : 31.975404605650933,
					lon : -81.23600006103516,
					size : 100,
					info : "2 men mugged."
				});
				my_markers.push({
					lat : 31.98050102903367,
					lon : -81.22982025146484,
					size : 100,
					info : "Hit and run"
				});

				my_markers.push({
					lat : 31.977151982694277,
					lon : -81.2409782409668,
					size : 100,
					info : "Broken window"
				});

				my_markers.push({
					lat : 31.975258989395627,
					lon : -81.22552871704102,
					size : 100,
					info : "car stolen."
				});
				L.tileLayer('http://otile1.mqcdn.com/tiles/1.0.0/map/{z}/{x}/{y}.jpg', {
					attribution : 'Map data &copy; [...]',
					maxZoom : 18

				}).addTo(map);

				// map.setView([31.9951, -81.2723], 13);

				map.locate({
					setView : false,
					maxZoom : 16
				});

				for (var i = 0; i < my_markers.length; i++) {
					addHeatMapCircle(my_markers[i].lat, my_markers[i].lon, my_markers[i].size, my_markers[i].info);
				}
				
				$("#btn-create").click(function(){
					
				});
				function addHeatMapCircle(lat, lon, size, info) {
					var a_circle = L.circle([lat, lon], size, {
						color : 'red',
						fillColor : '#f03',
						fillOpacity : 0.5
					}).addTo(map);
					a_circle.bindPopup("<img style=\"width:150px\" src=\"crimestats.png\" />");

				}

				$("#newReport").click(function(){
					console.log('click');
				});
				function onMapClick(e) {
					var lat = e.latlng.lat;
					var lon = e.latlng.lng;
					console.log(lat + " " + lon);
					addHeatMapCircle(lat, lon, 100, "Random circle");

					if (selectLocation) {
						$("#lat").val(e.latlng.lat);
						$("#lng").val(e.latlng.lng);
						selectLocation = false;
						$("#goToNew").click();
					} else {
						// Do nothing
					}
				}


				map.on('click', onMapClick);
				function onLocationFound(e) {
					map.setView([e.latlng.lat, e.latlng.lng], 15);
					L.marker([e.latlng.lat, e.latlng.lng], {
						clickable : true
					}).addTo(map);
				}


				map.on('locationfound', onLocationFound);

				function onLocationError(e) {

					//31.97744320896701 -81.23308181762695
					map.setView([31.97744320896701, -81.23308181762695], 15);
				}


				map.on('locationerror', onLocationError);

				$(window).resize(function() {
					sizeMap();
				});

				function sizeMap() {  
					$("#map-canvas").height($("#landing").height() - (125));

				}


				$("#clickMap").click(function() {
					$("#goToMap").click();
					selectLocation = true;
				});

				$("#addHeatToMap").click(function() {
					var lat = $("#lat").val();
					var lon = $("#lng").val();
					var size = $("#heatSize").val();
					var info = $("#infoArea").val();
					addHeatMapCircle(lat, lon, size, info);
					$("#goToMap").click();
				});
			});

		</script>
	</body>
</html>
